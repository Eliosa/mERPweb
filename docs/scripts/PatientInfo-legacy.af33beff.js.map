{"version":3,"file":"PatientInfo-legacy.af33beff.js","sources":["../../src/views/patient/PatientInfo.vue"],"sourcesContent":["<script lang=\"ts\">\nexport default {\n  name: 'PatientInfo',\n}\n</script>\n\n<script setup lang=\"ts\">\nimport PageContainer from '@/components/pageContainer/PageContainer.vue'\nimport { onMounted, computed } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Search } from '@element-plus/icons-vue'\nimport { usePatientInfoStore } from '@/stores/patientInfoStore'\nimport { storeToRefs } from 'pinia'\n\nconst router = useRouter()\nconst patientStore = usePatientInfoStore()\n\n// 从 store 中解构需要的状态和方法\nconst { searchForm, loading, patientList } = storeToRefs(patientStore)\nconst { fetchPatientList, resetSearchForm } = patientStore\n\n// 搜索类型选项\nconst searchTypeOptions = [\n  { label: '病患姓名', value: 'name' },\n  { label: '医生姓名', value: 'doctorName' },\n  { label: '血型', value: 'bloodType' },\n  { label: '住院号', value: 'id' },\n  { label: '申请单号', value: 'applicationNumber' },\n]\n\n// 手术状态选项\nconst surgeryStatusOptions = [\n  { label: '全部', value: '' },\n  { label: '手术中', value: 'in_progress' },\n  { label: '待手术', value: 'pending' },\n  { label: '已完成', value: 'completed' },\n]\n\n// 交接状态选项\nconst handOverStatusOptions = [\n  { label: '全部', value: '' },\n  { label: '已交接', value: 'completed' },\n  { label: '未交接', value: 'pending' },\n]\n\n// 手术间选项\nconst operatingRoomOptions = [\n  { label: '全部', value: '' },\n  { label: '04手术间', value: '04' },\n  { label: '13手术间', value: '13' },\n  { label: '14手术间', value: '14' },\n  { label: '15手术间', value: '15' },\n]\n\n// 获取手术状态对应的颜色\nconst getStatusColor = (status: string) => {\n  const colorMap: Record<string, string> = {\n    pending: '#ff9900',\n    in_progress: '#409eff',\n    completed: '#67c23a',\n  }\n  return colorMap[status] || '#909399'\n}\n\n// 计算搜索框的提示文本\nconst searchPlaceholder = computed(() => {\n  const selectedType = searchTypeOptions.find((item) => item.value === searchForm.value?.searchType)\n  return `请输入${selectedType?.label || ''}`\n})\n\n// 处理搜索\nconst handleSearch = () => {\n  fetchPatientList()\n}\n\n// 处理重置\nconst handleReset = () => {\n  resetSearchForm()\n  fetchPatientList()\n}\n\n// 处理卡片点击\nconst handleCardClick = async (patient: Patient_API.PatientInfo) => {\n  // 使用 replace 而不是 push，避免历史记录堆积\n  await router.replace({\n    name: 'PatientDetail',\n    params: {\n      id: patient.id,\n      name: patient.name,\n    },\n  })\n}\n\n// 组件挂载时获取数据\nonMounted(() => {\n  fetchPatientList()\n})\n</script>\n\n<template>\n  <PageContainer>\n    <!-- 搜索表单 -->\n    <el-form :model=\"searchForm\" class=\"search-form\" inline>\n      <!-- 手术时间区间 -->\n      <el-form-item label=\"手术时间\">\n        <el-date-picker\n          v-model=\"searchForm.surgeryTimeStart\"\n          type=\"datetime\"\n          placeholder=\"开始时间\"\n          format=\"YYYY-MM-DD HH:mm\"\n          value-format=\"YYYY-MM-DD HH:mm\"\n          :default-time=\"new Date(2000, 1, 1, 8, 0, 0)\"\n          clearable\n          class=\"time-picker\"\n        />\n        <span class=\"time-separator\">至</span>\n        <el-date-picker\n          v-model=\"searchForm.surgeryTimeEnd\"\n          type=\"datetime\"\n          placeholder=\"结束时间\"\n          format=\"YYYY-MM-DD HH:mm\"\n          value-format=\"YYYY-MM-DD HH:mm\"\n          :default-time=\"new Date(2000, 1, 1, 23, 59, 59)\"\n          clearable\n          class=\"time-picker\"\n        />\n      </el-form-item>\n\n      <!-- 手术间 -->\n      <el-form-item label=\"手术间\" :span=\"24\" class=\"width300\">\n        <el-select v-model=\"searchForm.operatingRoom\" placeholder=\"请选择手术间\" clearable>\n          <el-option\n            v-for=\"item in operatingRoomOptions\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          />\n        </el-select>\n      </el-form-item>\n\n      <!-- 手术状态 -->\n      <el-form-item label=\"手术状态\" class=\"width300\">\n        <el-select v-model=\"searchForm.surgeryStatus\" placeholder=\"请选择手术状态\" clearable>\n          <el-option\n            v-for=\"item in surgeryStatusOptions\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          />\n        </el-select>\n      </el-form-item>\n\n      <!-- 交接状态 -->\n      <el-form-item label=\"交接状态\" class=\"width300\">\n        <el-select v-model=\"searchForm.handOverStatus\" placeholder=\"请选择交接状态\" clearable>\n          <el-option\n            v-for=\"item in handOverStatusOptions\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          />\n        </el-select>\n      </el-form-item>\n\n      <!-- 搜索类型和值 -->\n      <el-form-item>\n        <div class=\"search-input-group\">\n          <el-select\n            v-model=\"searchForm.searchType\"\n            placeholder=\"搜索类型\"\n            class=\"search-type-select\"\n          >\n            <el-option\n              v-for=\"item in searchTypeOptions\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            />\n          </el-select>\n          <el-input\n            v-model=\"searchForm.searchValue\"\n            :placeholder=\"searchPlaceholder\"\n            clearable\n            class=\"search-value-input\"\n          />\n        </div>\n      </el-form-item>\n\n      <!-- 操作按钮 -->\n      <el-form-item>\n        <el-button type=\"primary\" :icon=\"Search\" @click=\"handleSearch\">搜索</el-button>\n        <el-button @click=\"handleReset\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\n    <!-- 患者卡片列表 -->\n    <div class=\"patient-cards\" v-loading=\"loading\">\n      <el-card\n        v-for=\"patient in patientList\"\n        :key=\"patient.id\"\n        class=\"patient-card\"\n        @click=\"handleCardClick(patient)\"\n      >\n        <!-- 卡片标题栏 -->\n        <div\n          class=\"card-header\"\n          :style=\"{ backgroundColor: getStatusColor(patient.surgeryStatus) }\"\n        >\n          <div class=\"header-info\">\n            <span>{{ patient.operatingRoom }}</span>\n            <el-divider direction=\"vertical\" />\n            <span>{{ patient.bloodType }}</span>\n            <el-divider direction=\"vertical\" />\n            <span>{{ patient.bedNumber }}</span>\n          </div>\n          <div class=\"status-tag\">\n            {{\n              surgeryStatusOptions.find((item) => item.value === patient.surgeryStatus)?.label ||\n              '未知'\n            }}\n          </div>\n        </div>\n\n        <!-- 卡片内容 -->\n        <div class=\"card-content\">\n          <div class=\"patient-info\">\n            <div class=\"info-row\">\n              <span class=\"patient-name\">{{ patient.name }}</span>\n              <span class=\"patient-gender-age\">{{ patient.gender }} {{ patient.age }}岁</span>\n            </div>\n            <div class=\"info-row\">\n              <span>住院号：{{ patient.id }}</span>\n            </div>\n            <div class=\"info-row\">\n              <span>申请单号：{{ patient.applicationNumber }}</span>\n            </div>\n            <div class=\"info-row\">\n              <span>手术医生：{{ patient.doctorName }}</span>\n            </div>\n            <div class=\"info-row\">\n              <span>护理等级：{{ patient.nursingLevel }}</span>\n            </div>\n          </div>\n        </div>\n      </el-card>\n    </div>\n  </PageContainer>\n</template>\n\n<style scoped lang=\"less\">\n.search-form {\n  background-color: #fff;\n  border-radius: 4px;\n  margin-bottom: 20px;\n\n  .time-picker {\n    width: 180px;\n  }\n\n  .time-separator {\n    margin: 0 8px;\n    color: #606266;\n  }\n\n  .search-input-group {\n    display: flex;\n    align-items: center;\n    gap: 0px;\n\n    .search-type-select {\n      width: 120px;\n    }\n\n    .search-value-input {\n      width: 200px;\n    }\n  }\n}\n\n.patient-cards {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 20px;\n  padding: 20px;\n  background-color: #f5f7fa;\n  min-height: 200px;\n}\n\n.patient-card {\n  cursor: pointer;\n  transition: all 0.3s;\n\n  &:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  }\n\n  .card-header {\n    margin: -20px -20px 15px;\n    padding: 10px 20px;\n    color: #fff;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    .header-info {\n      display: flex;\n      align-items: center;\n\n      .el-divider {\n        margin: 0 10px;\n        background-color: rgba(255, 255, 255, 0.5);\n      }\n    }\n\n    .status-tag {\n      padding: 2px 8px;\n      border-radius: 4px;\n      background-color: rgba(255, 255, 255, 0.2);\n      font-size: 12px;\n    }\n  }\n\n  .card-content {\n    .patient-info {\n      .info-row {\n        margin-bottom: 8px;\n        color: #606266;\n        font-size: 14px;\n\n        &:first-child {\n          margin-bottom: 12px;\n        }\n\n        .patient-name {\n          font-size: 16px;\n          font-weight: bold;\n          color: #303133;\n          margin-right: 10px;\n        }\n\n        .patient-gender-age {\n          color: #909399;\n        }\n      }\n    }\n  }\n}\n</style>\n"],"names":["name","router","useRouter","patientStore","usePatientInfoStore","searchForm","loading","patientList","storeToRefs","fetchPatientList","resetSearchForm","searchTypeOptions","label","value","surgeryStatusOptions","handOverStatusOptions","operatingRoomOptions","searchPlaceholder","computed","selectedType","find","item","_searchForm$value","searchType","handleSearch","handleReset","handleCardClick","_ref","patient","replace","params","id","_x","apply","arguments","onMounted","_createBlock","PageContainer","_createVNode","_component_el_form","model","_unref","class","inline","_component_el_form_item","_component_el_date_picker","modelValue","surgeryTimeStart","_cache","$event","type","placeholder","format","Date","clearable","_createElementVNode","surgeryTimeEnd","span","_component_el_select","operatingRoom","_createElementBlock","_Fragment","_renderList","_component_el_option","key","surgeryStatus","handOverStatus","_hoisted_1","_component_el_input","searchValue","_component_el_button","icon","Search","onClick","_withDirectives","_openBlock","_hoisted_2","_component_el_card","_surgeryStatusOptions","status","style","_normalizeStyle","backgroundColor","pending","in_progress","completed","_hoisted_3","_toDisplayString","_component_el_divider","direction","bloodType","bedNumber","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","gender","age","_hoisted_10","_hoisted_11","applicationNumber","_hoisted_12","doctorName","_hoisted_13","nursingLevel"],"mappings":"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"}