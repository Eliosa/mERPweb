{"version":3,"mappings":"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","names":["name","route","useRoute","patientInfoStore","usePatientInfoStore","detailTabs","activeTab","storeToRefs","navItems","id","title","children","component","defineAsyncComponent","__vitePreload","import","getNavItemById","findItem","items","targetId","item","found","handleNavClick","addDetailTab","value","patientId","handleTabClose","tabId","closeDetailTab","initPatientTabs","params","patientName","console","log","_a","length","setActiveTab","tabInfo","onMounted","onActivated","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_menu","class","_Fragment","_renderList","key","_createBlock","_component_el_sub_menu","index","_toDisplayString","child","_component_el_menu_item","onClick","$event","_createTextVNode","_hoisted_3","_unref","unref","_hoisted_4","_component_el_tabs","modelValue","_cache","type","closable","onTabRemove","tab","_component_el_tab_pane","label","_resolveDynamicComponent"],"sources":["../../src/views/patient/patientDetail/PatientDetail.vue"],"sourcesContent":["<script lang=\"ts\">\nexport default {\n  name: 'PatientDetail',\n}\n</script>\n\n<script setup lang=\"ts\">\nimport { usePatientInfoStore } from '@/stores/patientInfoStore'\nimport { storeToRefs } from 'pinia'\nimport { defineAsyncComponent, onMounted, onActivated } from 'vue'\nimport type { Component } from 'vue'\nimport { useRoute } from 'vue-router'\n\nconst route = useRoute()\nconst patientInfoStore = usePatientInfoStore()\nconst { detailTabs, activeTab } = storeToRefs(patientInfoStore)\n\ninterface NavItem {\n  id: string\n  title: string\n  component?: Component\n  children?: NavItem[]\n}\n\n// 默认打开的标签页ID\nconst defaultOpenTabId = 'patient-basic'\n// 导航菜单配置\nconst navItems: NavItem[] = [\n  {\n    id: 'basic',\n    title: '基本信息',\n    children: [\n      {\n        id: 'patient-basic',\n        title: '患者基本信息',\n        component: defineAsyncComponent(() => import('./components/PatientBasicInfo.vue')),\n      },\n      {\n        id: 'patient-surgery',\n        title: '手术信息',\n        component: defineAsyncComponent(() => import('./components/PatientSurgeryInfo.vue')),\n      },\n    ],\n  },\n  {\n    id: 'nursing',\n    title: '护理信息',\n    component: defineAsyncComponent(() => import('./components/PatientNursingInfo.vue')),\n  },\n  {\n    id: 'records',\n    title: '病历记录',\n    component: defineAsyncComponent(() => import('./components/PatientMedicalRecords.vue')),\n  },\n]\n\n// 根据ID获取导航项\nconst getNavItemById = (id: string) => {\n  const findItem = (items: NavItem[], targetId: string): NavItem | undefined => {\n    for (const item of items) {\n      if (item.id === targetId) return item\n      if (item.children) {\n        const found = findItem(item.children, targetId)\n        if (found) return found\n      }\n    }\n    return undefined\n  }\n  return findItem(navItems, id)\n}\n\n// 处理导航点击\nconst handleNavClick = (item: NavItem) => {\n  if (item.id) {\n    patientInfoStore.addDetailTab(activeTab.value.patientId, item.title, {\n      id: item.id,\n      title: item.title,\n    })\n  }\n}\n\n// 处理标签页关闭\nconst handleTabClose = (tabId: string) => {\n  patientInfoStore.closeDetailTab(activeTab.value.patientId, tabId)\n}\n\n// 初始化或更新患者标签页\nconst initPatientTabs = () => {\n  const patientId = route.params.id as string\n  const patientName = route.params.name as string\n\n  console.log('初始化/更新患者标签页:', { patientId, patientName })\n\n  // 如果该患者没有标签页，添加默认标签页\n  if (!detailTabs.value[patientId]?.length) {\n    const tabInfo = getNavItemById(defaultOpenTabId)\n    patientInfoStore.addDetailTab(patientId, patientName, {\n      id: tabInfo?.id || '',\n      title: tabInfo?.title || '',\n    })\n  } else {\n    patientInfoStore.setActiveTab(patientId, patientName, detailTabs.value[patientId][0].id)\n  }\n}\n\n// 监听路由参数变化\n// watch(\n//   () => route.params,\n//   () => {\n//     initPatientTabs()\n//   },\n// )\n\nonMounted(() => {\n  initPatientTabs()\n})\n\nonActivated(() => {\n  console.log('组件激活，更新患者信息')\n  initPatientTabs()\n})\n</script>\n\n<template>\n  <div class=\"patient-detail\">\n    <!-- 左侧导航 -->\n    <div class=\"nav-sidebar\">\n      <!-- :default-openeds=\"[defaultOpenTabId]\" -->\n      <el-menu class=\"nav-menu\">\n        <template v-for=\"item in navItems\" :key=\"item.id\">\n          <!-- 带子菜单的导航项 -->\n          <template v-if=\"item.children?.length\">\n            <el-sub-menu :index=\"item.id\">\n              <template #title>\n                <span>{{ item.title }}</span>\n              </template>\n              <el-menu-item\n                v-for=\"child in item.children\"\n                :key=\"child.id\"\n                :index=\"child.id\"\n                @click=\"handleNavClick(child)\"\n              >\n                {{ child.title }}\n              </el-menu-item>\n            </el-sub-menu>\n          </template>\n          <!-- 普通导航项 -->\n          <template v-else>\n            <el-menu-item :index=\"item.id\" @click=\"handleNavClick(item)\">\n              {{ item.title }}\n            </el-menu-item>\n          </template>\n        </template>\n      </el-menu>\n    </div>\n\n    <!-- 右侧内容区 -->\n    <div class=\"content-area\">\n      <!-- 标签页导航 -->\n      <div class=\"tabs-container\" v-if=\"detailTabs[activeTab.patientId]?.length > 0\">\n        <el-tabs\n          v-model=\"activeTab.tabId\"\n          type=\"card\"\n          closable\n          @tab-remove=\"handleTabClose\"\n          class=\"detail-tabs\"\n        >\n          <el-tab-pane\n            v-for=\"tab in detailTabs[activeTab.patientId]\"\n            :key=\"tab.id\"\n            :label=\"tab.title\"\n            :name=\"tab.id\"\n          >\n            <component\n              :is=\"getNavItemById(tab.id)?.component\"\n              :patient-id=\"activeTab.patientId\"\n              :tab-type=\"tab.id\"\n            />\n          </el-tab-pane>\n        </el-tabs>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped lang=\"less\">\n.patient-detail {\n  display: flex;\n  height: 100%;\n  background-color: #f5f7fa;\n\n  .nav-sidebar {\n    width: 200px;\n    background-color: #fff;\n    border-right: 1px solid #e4e7ed;\n\n    .nav-menu {\n      height: 100%;\n      border: none;\n    }\n  }\n\n  .content-area {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n\n    .tabs-container {\n      background: #fff;\n      border-bottom: 1px solid #e4e7ed;\n      padding: 0 16px;\n      height: 40px;\n      flex-shrink: 0;\n\n      .detail-tabs {\n        :deep(.el-tabs__header) {\n          margin: 0;\n          border: none;\n        }\n\n        :deep(.el-tabs__nav-wrap) {\n          &::after {\n            display: none;\n          }\n        }\n\n        :deep(.el-tabs__item) {\n          border: 1px solid #d9d9d9;\n          margin-right: 4px;\n          border-radius: 4px 4px 0 0;\n          padding: 0 16px;\n\n          &.is-active {\n            background: #409eff;\n            color: #ffffff;\n            border-color: #409eff;\n          }\n        }\n      }\n    }\n\n    .page-content {\n      flex: 1;\n      overflow: auto;\n      padding: 16px;\n    }\n  }\n}\n</style>\n"],"file":"scripts/PatientDetail.6c45daa9.js"}