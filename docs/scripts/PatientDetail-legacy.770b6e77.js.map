{"version":3,"file":"PatientDetail-legacy.770b6e77.js","sources":["../../src/views/patient/patientDetail/PatientDetail.vue"],"sourcesContent":["<script lang=\"ts\">\nexport default {\n  name: 'PatientDetail',\n}\n</script>\n\n<script setup lang=\"ts\">\nimport { usePatientInfoStore } from '@/stores/patientInfoStore'\nimport { storeToRefs } from 'pinia'\nimport { defineAsyncComponent, onMounted, onActivated } from 'vue'\nimport type { Component } from 'vue'\nimport { useRoute } from 'vue-router'\nimport type { TabPaneName } from 'element-plus'\n\n// 定义类型\ninterface NavItem {\n  id: string\n  title: string\n  component?: Component\n  children?: NavItem[]\n}\n\ninterface TabInfo {\n  id: string\n  title: string\n}\n\nconst route = useRoute()\nconst patientInfoStore = usePatientInfoStore()\nconst { detailTabs, activeTab } = storeToRefs(patientInfoStore)\n\n// 默认打开的标签页ID\nconst defaultOpenTabId = 'basic'\n\n// 导航菜单配置\nconst navItems: NavItem[] = [\n  {\n    id: 'external-url-demo',\n    title: '外部URL DEMO',\n    component: defineAsyncComponent(() => import('./components/ExternalUrlDemo.vue')),\n  },\n  {\n    id: 'basic',\n    title: '基本信息',\n    component: defineAsyncComponent(() => import('./components/PatientBasicInfo.vue')),\n  },\n  {\n    id: 'medical-advice',\n    title: '医嘱信息',\n    component: defineAsyncComponent(() => import('./components/MedicalAdvice.vue')),\n  },\n  {\n    id: 'nursing',\n    title: '护理文书',\n    children: [\n      {\n        id: 'surgery-nursing-record',\n        title: '手术护理记录单',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/SurgeryNursingRecord.vue'),\n        ),\n      },\n      {\n        id: 'surgery-nursing-record-local',\n        title: '手术护理记录单（局麻）',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/SurgeryNursingRecordLocal.vue'),\n        ),\n      },\n      {\n        id: 'surgery-safety-checklist',\n        title: '手术安全核查表',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/SurgerySafetyChecklist.vue'),\n        ),\n      },\n      {\n        id: 'surgery-instrument-checklist',\n        title: '手术器械清点单',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/SurgeryInstrumentChecklist.vue'),\n        ),\n      },\n      {\n        id: 'skin-prep-checklist',\n        title: '皮肤准备核查表',\n        component: defineAsyncComponent(() => import('./components/nursing/SkinPrepChecklist.vue')),\n      },\n      {\n        id: 'corn-risk-assessment',\n        title: 'CORN术中获得性压力性损伤风险评估单',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/CornRiskAssessment.vue'),\n        ),\n      },\n      {\n        id: 'special-position-card',\n        title: '特殊体位术中手术关注卡',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/SpecialPositionCard.vue'),\n        ),\n      },\n      {\n        id: 'surgery-items-checklist',\n        title: '手术病人所需物品清单',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/SurgeryItemsChecklist.vue'),\n        ),\n      },\n      {\n        id: 'implant-device-register',\n        title: '植入医疗器械使用登记表',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/ImplantDeviceRegister.vue'),\n        ),\n      },\n      {\n        id: 'implant-device-acceptance',\n        title: '植入医疗器械使用验收登记表',\n        component: defineAsyncComponent(\n          () => import('./components/nursing/ImplantDeviceAcceptance.vue'),\n        ),\n      },\n      {\n        id: 'consultation-form',\n        title: '会诊单',\n        component: defineAsyncComponent(() => import('./components/nursing/ConsultationForm.vue')),\n      },\n      {\n        id: 'surgery-follow-up',\n        title: '手术室随访记录单',\n        component: defineAsyncComponent(() => import('./components/nursing/SurgeryFollowUp.vue')),\n      },\n    ],\n  },\n  {\n    id: 'intervention',\n    title: '介入文书',\n    children: [\n      {\n        id: 'intervention-nursing-record',\n        title: '介入护理记录单',\n        component: defineAsyncComponent(\n          () => import('./components/intervention/InterventionNursingRecord.vue'),\n        ),\n      },\n      {\n        id: 'intervention-rescue-record',\n        title: '介入护理抢救记录单',\n        component: defineAsyncComponent(\n          () => import('./components/intervention/InterventionRescueRecord.vue'),\n        ),\n      },\n      {\n        id: 'intervention-surgery-record',\n        title: '介入手术护理记录单',\n        component: defineAsyncComponent(\n          () => import('./components/intervention/InterventionSurgeryRecord.vue'),\n        ),\n      },\n      {\n        id: 'intervention-materials-record',\n        title: '介入耗材使用记录表',\n        component: defineAsyncComponent(\n          () => import('./components/intervention/InterventionMaterialsRecord.vue'),\n        ),\n      },\n    ],\n  },\n  {\n    id: 'handover',\n    title: '患者交接',\n    children: [\n      {\n        id: 'surgery-handover-record',\n        title: '手术患者交接记录单',\n        component: defineAsyncComponent(\n          () => import('./components/handover/SurgeryHandoverRecord.vue'),\n        ),\n      },\n      {\n        id: 'day-surgery-handover-record',\n        title: '日间手术患者交接记录单',\n        component: defineAsyncComponent(\n          () => import('./components/handover/DaySurgeryHandoverRecord.vue'),\n        ),\n      },\n    ],\n  },\n  {\n    id: 'pathology',\n    title: '病理标本管理',\n    children: [\n      {\n        id: 'pathology-print',\n        title: '病理标本打印',\n        component: defineAsyncComponent(() => import('./components/pathology/PathologyPrint.vue')),\n      },\n      {\n        id: 'pathology-register',\n        title: '病理标本登记记录',\n        component: defineAsyncComponent(\n          () => import('./components/pathology/PathologyRegister.vue'),\n        ),\n      },\n    ],\n  },\n]\n\n// 根据ID获取导航项\nconst getNavItemById = (id: string): NavItem | undefined => {\n  const findItem = (items: NavItem[], targetId: string): NavItem | undefined => {\n    for (const item of items) {\n      if (item.id === targetId) return item\n      if (item.children) {\n        const found = findItem(item.children, targetId)\n        if (found) return found\n      }\n    }\n    return undefined\n  }\n  return findItem(navItems, id)\n}\n\n// 处理导航点击\nconst handleNavClick = (item: NavItem) => {\n  if (item.id) {\n    const tabInfo: TabInfo = {\n      id: item.id,\n      title: item.title,\n    }\n    patientInfoStore.addDetailTab(activeTab.value.patientId, activeTab.value.patientName, tabInfo)\n  }\n}\n\n// 处理标签页关闭\nconst handleTabClose = (tabId: TabPaneName) => {\n  patientInfoStore.closeDetailTab(activeTab.value.patientId, tabId.toString())\n}\n\n// 初始化或更新患者标签页\nconst initPatientTabs = () => {\n  const patientId = route.params.id as string\n  const patientName = route.params.name as string\n\n  // 如果该患者没有标签页，添加默认标签页\n  if (!detailTabs.value[patientId]?.length) {\n    const tabInfo = getNavItemById(defaultOpenTabId)\n    if (tabInfo) {\n      patientInfoStore.addDetailTab(patientId, patientName, {\n        id: tabInfo.id,\n        title: tabInfo.title,\n      })\n    }\n  } else {\n    patientInfoStore.setActiveTab(patientId, patientName, detailTabs.value[patientId][0].id)\n  }\n}\n\nonMounted(() => {\n  initPatientTabs()\n})\n\nonActivated(() => {\n  console.log('组件激活，更新患者信息')\n  initPatientTabs()\n})\n</script>\n\n<template>\n  <div class=\"patient-detail\">\n    <!-- 左侧导航 -->\n    <el-scrollbar class=\"nav-sidebar\" height=\"100%\">\n      <!-- :default-openeds=\"[defaultOpenTabId]\" -->\n      <el-menu class=\"nav-menu\">\n        <template v-for=\"item in navItems\" :key=\"item.id\">\n          <!-- 一级菜单（带子菜单） -->\n          <template v-if=\"item.children?.length\">\n            <div class=\"first-level-menu\">\n              <span class=\"font-bold\">{{ item.title }}</span>\n            </div>\n            <el-menu-item\n              v-for=\"child in item.children\"\n              :key=\"child.id\"\n              :index=\"child.id\"\n              class=\"sub-menu-item\"\n              @click=\"handleNavClick(child)\"\n            >\n              {{ child.title }}\n            </el-menu-item>\n          </template>\n          <!-- 一级菜单（无子菜单） -->\n          <template v-else>\n            <el-menu-item :index=\"item.id\" class=\"first-level-menu\" @click=\"handleNavClick(item)\">\n              <span class=\"font-bold\">{{ item.title }}</span>\n            </el-menu-item>\n          </template>\n        </template>\n      </el-menu>\n    </el-scrollbar>\n\n    <!-- 右侧内容区 -->\n    <div class=\"content-area\">\n      <!-- 标签页导航 -->\n      <div class=\"tabs-container\" v-if=\"detailTabs[activeTab.patientId]?.length > 0\">\n        <el-tabs\n          v-model=\"activeTab.tabId\"\n          type=\"card\"\n          :closable=\"detailTabs[activeTab.patientId]?.length > 1\"\n          @tab-remove=\"handleTabClose\"\n          class=\"detail-tabs\"\n        >\n          <el-tab-pane\n            v-for=\"tab in detailTabs[activeTab.patientId]\"\n            :key=\"tab.id\"\n            :label=\"tab.title\"\n            :name=\"tab.id\"\n          >\n            <component\n              :is=\"getNavItemById(tab.id)?.component\"\n              :patient-id=\"activeTab.patientId\"\n              :tab-type=\"tab.id\"\n            />\n          </el-tab-pane>\n        </el-tabs>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped lang=\"less\">\n.patient-detail {\n  display: flex;\n  height: 100%;\n  background-color: #f5f7fa;\n\n  .nav-sidebar {\n    width: 300px;\n    background-color: #fff;\n    border-right: 1px solid #e4e7ed;\n\n    .nav-menu {\n      height: 100%;\n      border: none;\n    }\n  }\n\n  .content-area {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n\n    .tabs-container {\n      margin: 5px;\n      height: 40px;\n      flex-shrink: 0;\n\n      .detail-tabs {\n        :deep(.el-tabs__header) {\n          margin: 0;\n          border: none;\n        }\n\n        :deep(.el-tabs__nav-wrap) {\n          &::after {\n            display: none;\n          }\n        }\n\n        :deep(.el-tabs__item) {\n          // border: 1px solid #d9d9d9;\n          // margin-right: 4px;\n          border-radius: 4px 4px 0 0;\n          padding: 0 16px;\n\n          &.is-active {\n            color: #3e8ce7;\n            background: #fff;\n          }\n        }\n      }\n    }\n  }\n\n  .nav-menu {\n    :deep(.el-menu-item) {\n      height: 40px;\n      line-height: 40px;\n    }\n\n    .first-level-menu {\n      padding: 0 20px;\n      height: 40px;\n      line-height: 40px;\n      font-size: 14px;\n    }\n\n    .sub-menu-item {\n      padding-left: 40px !important;\n    }\n\n    .font-bold {\n      font-weight: bold;\n    }\n  }\n}\n</style>\n"],"names":["name","route","useRoute","patientInfoStore","usePatientInfoStore","detailTabs","activeTab","storeToRefs","navItems","id","title","component","defineAsyncComponent","__vitePreload","module","import","children","getNavItemById","findItem","items","targetId","item","found","handleNavClick","tabInfo","addDetailTab","value","patientId","patientName","handleTabClose","tabId","closeDetailTab","toString","initPatientTabs","_detailTabs$value$pat","params","length","setActiveTab","onMounted","onActivated","console","log","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_component_el_scrollbar","class","height","_component_el_menu","_Fragment","_renderList","_item$children","key","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","child","_createBlock","_component_el_menu_item","index","onClick","$event","_createTextVNode","_hoisted_4","_hoisted_5","_unref","_unref$unref$patientI","_hoisted_6","_component_el_tabs","modelValue","_cache","type","closable","_unref$unref$patientI2","onTabRemove","tab","_component_el_tab_pane","label","_getNavItemById","_resolveDynamicComponent"],"mappings":"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"}