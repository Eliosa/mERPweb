{"version":3,"file":"PatientInfo.e13591fb.js","sources":["../../src/views/patient/PatientInfo.vue"],"sourcesContent":["<script lang=\"ts\">\nexport default {\n  name: 'PatientInfo',\n}\n</script>\n\n<script setup lang=\"ts\">\nimport PageContainer from '@/components/pageContainer/PageContainer.vue'\nimport { onMounted, computed } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Search } from '@element-plus/icons-vue'\nimport { usePatientInfoStore } from '@/stores/patientInfoStore'\nimport { storeToRefs } from 'pinia'\n\nconst router = useRouter()\nconst patientStore = usePatientInfoStore()\n\n// 从 store 中解构需要的状态和方法\nconst { searchForm, loading, patientList } = storeToRefs(patientStore)\nconst { fetchPatientList, resetSearchForm } = patientStore\n\n// 搜索类型选项\nconst searchTypeOptions = [\n  { label: '病患姓名', value: 'name' },\n  { label: '医生姓名', value: 'doctorName' },\n  { label: '血型', value: 'bloodType' },\n  { label: '住院号', value: 'id' },\n  { label: '申请单号', value: 'applicationNumber' },\n]\n\n// 手术状态选项\nconst surgeryStatusOptions = [\n  { label: '全部', value: '' },\n  { label: '手术中', value: 'in_progress' },\n  { label: '待手术', value: 'pending' },\n  { label: '已完成', value: 'completed' },\n]\n\n// 交接状态选项\nconst handOverStatusOptions = [\n  { label: '全部', value: '' },\n  { label: '已交接', value: 'completed' },\n  { label: '未交接', value: 'pending' },\n]\n\n// 手术间选项\nconst operatingRoomOptions = [\n  { label: '全部', value: '' },\n  { label: '04手术间', value: '04' },\n  { label: '13手术间', value: '13' },\n  { label: '14手术间', value: '14' },\n  { label: '15手术间', value: '15' },\n]\n\n// 获取手术状态对应的颜色\nconst getStatusColor = (status: string) => {\n  const colorMap: Record<string, string> = {\n    pending: '#ff9900',\n    in_progress: '#409eff',\n    completed: '#67c23a',\n  }\n  return colorMap[status] || '#909399'\n}\n\n// 计算搜索框的提示文本\nconst searchPlaceholder = computed(() => {\n  const selectedType = searchTypeOptions.find((item) => item.value === searchForm.value?.searchType)\n  return `请输入${selectedType?.label || ''}`\n})\n\n// 处理搜索\nconst handleSearch = () => {\n  fetchPatientList()\n}\n\n// 处理重置\nconst handleReset = () => {\n  resetSearchForm()\n  fetchPatientList()\n}\n\n// 处理卡片点击\nconst handleCardClick = async (patient: Patient_API.PatientInfo) => {\n  // 使用 replace 而不是 push，避免历史记录堆积\n  await router.replace({\n    name: 'PatientDetail',\n    params: {\n      id: patient.id,\n      name: patient.name,\n    },\n  })\n}\n\n// 组件挂载时获取数据\nonMounted(() => {\n  fetchPatientList()\n})\n</script>\n\n<template>\n  <PageContainer>\n    <!-- 搜索表单 -->\n    <el-form :model=\"searchForm\" class=\"search-form\" inline>\n      <!-- 手术时间区间 -->\n      <el-form-item label=\"手术时间\">\n        <el-date-picker\n          v-model=\"searchForm.surgeryTimeStart\"\n          type=\"datetime\"\n          placeholder=\"开始时间\"\n          format=\"YYYY-MM-DD HH:mm\"\n          value-format=\"YYYY-MM-DD HH:mm\"\n          :default-time=\"new Date(2000, 1, 1, 8, 0, 0)\"\n          clearable\n          class=\"time-picker\"\n        />\n        <span class=\"time-separator\">至</span>\n        <el-date-picker\n          v-model=\"searchForm.surgeryTimeEnd\"\n          type=\"datetime\"\n          placeholder=\"结束时间\"\n          format=\"YYYY-MM-DD HH:mm\"\n          value-format=\"YYYY-MM-DD HH:mm\"\n          :default-time=\"new Date(2000, 1, 1, 23, 59, 59)\"\n          clearable\n          class=\"time-picker\"\n        />\n      </el-form-item>\n\n      <!-- 手术间 -->\n      <el-form-item label=\"手术间\" :span=\"24\" class=\"width300\">\n        <el-select v-model=\"searchForm.operatingRoom\" placeholder=\"请选择手术间\" clearable>\n          <el-option\n            v-for=\"item in operatingRoomOptions\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          />\n        </el-select>\n      </el-form-item>\n\n      <!-- 手术状态 -->\n      <el-form-item label=\"手术状态\" class=\"width300\">\n        <el-select v-model=\"searchForm.surgeryStatus\" placeholder=\"请选择手术状态\" clearable>\n          <el-option\n            v-for=\"item in surgeryStatusOptions\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          />\n        </el-select>\n      </el-form-item>\n\n      <!-- 交接状态 -->\n      <el-form-item label=\"交接状态\" class=\"width300\">\n        <el-select v-model=\"searchForm.handOverStatus\" placeholder=\"请选择交接状态\" clearable>\n          <el-option\n            v-for=\"item in handOverStatusOptions\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          />\n        </el-select>\n      </el-form-item>\n\n      <!-- 搜索类型和值 -->\n      <el-form-item>\n        <div class=\"search-input-group\">\n          <el-select\n            v-model=\"searchForm.searchType\"\n            placeholder=\"搜索类型\"\n            class=\"search-type-select\"\n          >\n            <el-option\n              v-for=\"item in searchTypeOptions\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            />\n          </el-select>\n          <el-input\n            v-model=\"searchForm.searchValue\"\n            :placeholder=\"searchPlaceholder\"\n            clearable\n            class=\"search-value-input\"\n          />\n        </div>\n      </el-form-item>\n\n      <!-- 操作按钮 -->\n      <el-form-item>\n        <el-button type=\"primary\" :icon=\"Search\" @click=\"handleSearch\">搜索</el-button>\n        <el-button @click=\"handleReset\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\n    <!-- 患者卡片列表 -->\n    <div class=\"patient-cards\" v-loading=\"loading\">\n      <el-card\n        v-for=\"patient in patientList\"\n        :key=\"patient.id\"\n        class=\"patient-card\"\n        @click=\"handleCardClick(patient)\"\n      >\n        <!-- 卡片标题栏 -->\n        <div\n          class=\"card-header\"\n          :style=\"{ backgroundColor: getStatusColor(patient.surgeryStatus) }\"\n        >\n          <div class=\"header-info\">\n            <span>{{ patient.operatingRoom }}</span>\n            <el-divider direction=\"vertical\" />\n            <span>{{ patient.bloodType }}</span>\n            <el-divider direction=\"vertical\" />\n            <span>{{ patient.bedNumber }}</span>\n          </div>\n          <div class=\"status-tag\">\n            {{\n              surgeryStatusOptions.find((item) => item.value === patient.surgeryStatus)?.label ||\n              '未知'\n            }}\n          </div>\n        </div>\n\n        <!-- 卡片内容 -->\n        <div class=\"card-content\">\n          <div class=\"patient-info\">\n            <div class=\"info-row\">\n              <span class=\"patient-name\">{{ patient.name }}</span>\n              <span class=\"patient-gender-age\">{{ patient.gender }} {{ patient.age }}岁</span>\n            </div>\n            <div class=\"info-row\">\n              <span>住院号：{{ patient.id }}</span>\n            </div>\n            <div class=\"info-row\">\n              <span>申请单号：{{ patient.applicationNumber }}</span>\n            </div>\n            <div class=\"info-row\">\n              <span>手术医生：{{ patient.doctorName }}</span>\n            </div>\n            <div class=\"info-row\">\n              <span>护理等级：{{ patient.nursingLevel }}</span>\n            </div>\n          </div>\n        </div>\n      </el-card>\n    </div>\n  </PageContainer>\n</template>\n\n<style scoped lang=\"less\">\n.search-form {\n  background-color: #fff;\n  border-radius: 4px;\n  margin-bottom: 20px;\n\n  .time-picker {\n    width: 180px;\n  }\n\n  .time-separator {\n    margin: 0 8px;\n    color: #606266;\n  }\n\n  .search-input-group {\n    display: flex;\n    align-items: center;\n    gap: 0px;\n\n    .search-type-select {\n      width: 120px;\n    }\n\n    .search-value-input {\n      width: 200px;\n    }\n  }\n}\n\n.patient-cards {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 20px;\n  padding: 20px;\n  background-color: #f5f7fa;\n  min-height: 200px;\n}\n\n.patient-card {\n  cursor: pointer;\n  transition: all 0.3s;\n\n  &:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  }\n\n  .card-header {\n    margin: -20px -20px 15px;\n    padding: 10px 20px;\n    color: #fff;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    .header-info {\n      display: flex;\n      align-items: center;\n\n      .el-divider {\n        margin: 0 10px;\n        background-color: rgba(255, 255, 255, 0.5);\n      }\n    }\n\n    .status-tag {\n      padding: 2px 8px;\n      border-radius: 4px;\n      background-color: rgba(255, 255, 255, 0.2);\n      font-size: 12px;\n    }\n  }\n\n  .card-content {\n    .patient-info {\n      .info-row {\n        margin-bottom: 8px;\n        color: #606266;\n        font-size: 14px;\n\n        &:first-child {\n          margin-bottom: 12px;\n        }\n\n        .patient-name {\n          font-size: 16px;\n          font-weight: bold;\n          color: #303133;\n          margin-right: 10px;\n        }\n\n        .patient-gender-age {\n          color: #909399;\n        }\n      }\n    }\n  }\n}\n</style>\n"],"names":["name","router","useRouter","patientStore","usePatientInfoStore","searchForm","loading","patientList","storeToRefs","fetchPatientList","resetSearchForm","searchTypeOptions","label","value","surgeryStatusOptions","handOverStatusOptions","operatingRoomOptions","searchPlaceholder","computed","selectedType","find","item","_a","searchType","concat","handleSearch","handleReset","onMounted","_createBlock","PageContainer","_createVNode","_component_el_form","model","_unref","class","inline","_component_el_form_item","_component_el_date_picker","modelValue","surgeryTimeStart","_cache","$event","type","placeholder","format","Date","clearable","_createElementVNode","surgeryTimeEnd","span","_component_el_select","operatingRoom","_createElementBlock","_Fragment","_renderList","_component_el_option","key","surgeryStatus","handOverStatus","_hoisted_1","_component_el_input","searchValue","_component_el_button","icon","Search","onClick","_withDirectives","_openBlock","_hoisted_2","patient","_component_el_card","id","async","replace","params","handleCardClick","status","style","_normalizeStyle","backgroundColor","pending","in_progress","completed","_hoisted_3","_toDisplayString","_component_el_divider","direction","bloodType","bedNumber","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","gender","age","_hoisted_10","_hoisted_11","applicationNumber","_hoisted_12","doctorName","_hoisted_13","nursingLevel"],"mappings":"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"}